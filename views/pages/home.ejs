<!DOCTYPE html>
<html>
  <head>
    <%- include("../partials/meta")%>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-3 col-sm-3 col-md-2 col-lg-2">
          <!-- Prettier Ignore -->
          <%- include("../partials/sidebar") %>
        </div>
        <div class="min-vh-100 col-sm-9 col-9 col-md-10 col-lg-6">
          <div class="content-container">
            <div class="px-2 pb-2 border-end border-start border-bottom">
              <h3>Home</h3>
              <div class="d-flex align-items-center">
                <img src="<%= user.avatar.includes("http")? user.avatar: `/img/${user.avatar}` %>"
                class="profileImage" />
                <form action="/tweets/store" class="w-100" method="post">
                  <input
                    type="text"
                    id="newTweet"
                    name="newTweet"
                    class="w-100 form-control"
                    placeholder=" What's happening?"
                  />

                  <div class="d-flex justify-content-end">
                    <button type="submit" class="btn bgTweeter rounded-pill mt-2">Tweet</button>
                  </div>
                </form>
              </div>
            </div>

            <!-- Prettier Ignore -->
            <% for (const tweet of tweets) { %>

            <!-- Esto es un comentario de prueba -->

            <div class="d-flex p-2 border-end border-start border-bottom w-100">
              <img src="<%= tweet.userId.avatar.includes("http")? tweet.userId.avatar:
              `/img/${tweet.userId.avatar}` %>" class="profileImage" />

              <div class="w-75">
                <div class="d-flex align-items-baseline w-100">
                  <a
                    class="text-decoration-none text-reset"
                    href="/usuarios/<%= tweet.userId.username %>"
                    ><h6 class="mb-0 mr-2">
                      <strong> <%= tweet.userId.firstname %> <%= tweet.userId.lastname %> </strong>
                    </h6></a
                  >
                  <p class="text-muted m-0 fs-6">@<%= tweet.userId.username %></p>
                </div>
                <p class="m-0" id="tweet-content"><%= tweet.body %></p>
                <div class="d-flex p-2 justify-content-between">
                  <form method="post" action="/tweets/<%= tweet.id  %>/like">
                    <button id="cora_<% tweet._id %>" type="submit" class="border-0 bg-transparent">
                      <i
                        class="<% if(tweet.likes.includes(locals.user.id)){%> fa-solid <%} else {%> fa-regular <%}%> text-danger fa-heart"
                      >
                      </i>
                    </button>
                    <span> <%= tweet.likes.length %> </span>
                  </form>
                  <% if(locals.user.id == tweet.userId._id){%>
                  <form method="POST" action="/tweets/<%= tweet._id %>?_method=DELETE">
                    <button type="submit" class="border-0 bg-transparent">
                      <i class="fa-solid fa-trash ms-auto"></i>
                    </button>
                  </form>
                  <%}%>
                </div>
              </div>
            </div>
            <% } %>
          </div>
        </div>

        <div class="col-md-4 col-lg-4 hidden-sm"><%- include("../partials/rightSidebar") %></div>
      </div>
    </div>
    <!-- <script src="/js/app.js"></script> -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/9f0d5f7751.js" crossorigin="anonymous"></script>
  </body>
</html>
